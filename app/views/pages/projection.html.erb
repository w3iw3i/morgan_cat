<% if user_signed_in? && Asset.exists?(user_id: @user.id) %>
  <%
    data = [
    {
      name: "Cash",
      data: @projected_amt
    },
    {
      name: "Stocks",
      data: @stocks_projection
    },
    {
      name: "Bonds",
      data: @bonds_projection
    },
    {
      name: "CPF-Ordinary",
      data: @cpfo_projection
    },
    {
      name: "CPF-Special",
      data: @cpfs_projection
    },
    {
      name: "CPF-Medisave",
      data: @cpfm_projection
    }
  ]
  %>

  <%=
      column_chart data,
      title: 'Asset Projection', stacked:true, ytitle: "Net Worth($)", min:0, thousands: ",", loading: "Loading...",
      library: {
        yAxis: {
            labels: {
                format: '${value}'
            }
        },
            tooltip: {
              pointFormat: 'Total Spent: <b>{point.y}</b>',
              xDateFormat: '%B',
              valuePrefix: '$'
            }
          }
  %>

<% else %>
  <%= column_chart @projected_amt,
      title: 'Asset Projection', stacked:true, ytitle: "Net Worth($)", min:0, thousands: ",", loading: "Loading...",
      library: {
        yAxis: {
            labels: {
                format: '${value}'
            }
        },
            tooltip: {
              pointFormat: 'Total Spent: <b>{point.y}</b>',
              xDateFormat: '%B',
              valuePrefix: '$'
            }
          }
  %>
<% end %>

<div class="container mt-5">
  <div class="row">
    <div class="col-md">
      <h4>Current Inputs</h4>
      <table>
        <tr>
          <td>Year of Birth : </td>
          <td><%= @user.dob.year %></td>
        </tr>
        <tr>
          <td>Income : </td>
          <td>$<%= @user.monthly_income %></td>
        </tr>
        <tr>
          <td>Expenses : </td>
          <td>$<%= @user.monthly_expenses %></td>
        </tr>
        <tr>
          <td>Inflation : </td>
          <td><%= @inflation %>%</td>
        </tr>
        <tr>
          <td>Retirement Age : </td>
          <td><%= @retirement_age %> years old</td>
        </tr>
      </table>
    </div>
    <div class="col-md">
      <div class="landing-btn">
        <% if user_signed_in? %>
          <p><%= link_to "Add Assets", assets_path, class: 'btn btn-gradient' %></p>
          <p><%= link_to "Add Expenses", user_expenses_path(@user.id), class: 'btn btn-gradient' %></p>
          <p><%= link_to "Scenario Planning", scenario_planning_path, class: 'btn btn-gradient' %></p>
        <% else %>
          <%= link_to "Sign up to customise", new_user_registration_path, class: 'btn btn-gradient' %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="mt-5 landing-btn">
  <%= link_to "Back to Home", root_path, class: 'btn btn-gradient' %>
</div>
