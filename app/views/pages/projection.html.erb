<% if user_signed_in? %>
  <%
    data = [
    {
      name: "Cash",
      data: @projected_amt
    },
    {
      name: "Stocks",
      data: @stocks_projection
    },
    {
      name: "Bonds",
      data: @bonds_projection
    },
    {
      name: "CPF-Ordinary",
      data: @cpfo_projection
    },
    {
      name: "CPF-Special",
      data: @cpfs_projection
    },
    {
      name: "CPF-Medisave",
      data: @cpfm_projection
    }
  ]
  %>

  <%=
      column_chart data,
      title: 'Asset Projection', stacked:true, ytitle: "Net Worth($)", min:0, thousands: ",", loading: "Loading...",
      library: {
        yAxis: {
            labels: {
                format: '${value}'
            }
        },
            tooltip: {
              pointFormat: 'Total Spent: <b>{point.y}</b>',
              xDateFormat: '%B',
              valuePrefix: '$'
            }
          }
  %>
<% else %>
  <%= column_chart @projected_amt,
      title: 'Asset Projection', stacked:true, ytitle: "Net Worth($)", min:0, thousands: ",", loading: "Loading...",
      library: {
        yAxis: {
            labels: {
                format: '${value}'
            }
        },
            tooltip: {
              pointFormat: 'Total Spent: <b>{point.y}</b>',
              xDateFormat: '%B',
              valuePrefix: '$'
            }
          }
  %>
<% end %>

<h2>Retirement Scenario Planning</h2>

<table id="expense-table">
  <col style="width:40%">
	<col style="width:20%">
	<col style="width:20%">
  <col style="width:20%">
  <tr>
    <th>Scenario (Stocks / Bonds / Cash) </th>
    <th>Average Outcome</th>
    <th>90th Percentile</th>
    <th>10th Percentile</th>
  </tr>



  <tr>
    <td>Current Allocation: <%= @stocks.asset_allocation %> / <%= @bonds.asset_allocation %> / <%= @cash.asset_allocation %> </td>
    <% i =0 %>
    <% while i < 3 do %>
      <td><%= number_to_currency(@baseline_scenario[i], unit: '$', separator: ",", precision: 0)%></td>
    <% i += 1 %>
    <% end %>
  </tr>

  <tr>
    <td>Moderate Risk Scenario: 80 / 10 / 10</td>
    <% i =0 %>
    <% while i < 3 do %>
      <td><%= number_to_currency(@stock80_scenario[i], unit: '$', separator: ",", precision: 0)%></td>
    <% i += 1 %>
    <% end %>
  </tr>

  <tr>
    <td>Low Risk Scenario: 60 / 30 / 10</td>
    <% i =0 %>
    <% while i < 3 do %>
      <td><%= number_to_currency(@stock60_scenario[i], unit: '$', separator: ",", precision: 0)%></td>
    <% i += 1 %>
    <% end %>
  </tr>
</table>
<br>
<%= link_to "Back to Home", root_path, class: 'btn btn-primary' %>
